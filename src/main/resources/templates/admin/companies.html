
<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Công ty | Học viện Kỹ thuật Mật mã</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
        }
        .sidebar-item-active {
            background-color: #f3f4f6;
            border-left: 4px solid #3b82f6;
            font-weight: 500;
        }
        .action-btn {
            transition: all 0.2s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
        }
        .status-active {
            background-color: #dcfce7;
            color: #166534;
        }
        .status-inactive {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        .status-gray {
            background-color: #e5e7eb; /* màu xám nhạt (gray-200 của Tailwind) */
            color: #374151; /* màu xám đậm (gray-700 của Tailwind) */
        }
        .status-pending {
            background-color: #fef9c3;
            color: #854d0e;
        }
        .company-row:hover {
            background-color: #f9fafb;
        }
        .tab-active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
            font-weight: 500;
        }
        .document-preview {
            height: 200px;
            background-color: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .document-preview:hover {
            background-color: #e5e7eb;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar-open {
                transform: translateX(0);
            }
        }
    </style>
    <th:block th:replace="~{narbarAdmin :: narbarStyle}"></th:block>
</head>
<body class="bg-gray-50">
<div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <th:block th:replace="~{narbarAdmin :: sidebar}"></th:block>

    <!-- Main Content -->
    <div class="flex-1 overflow-auto">
        <!-- Topbar -->
        <th:block th:replace="~{narbarAdmin :: topbar}"></th:block>

        <!-- Main Content -->
        <div class="p-6">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-2xl font-bold text-gray-800">Quản lý Công ty</h1>
                <div class="flex space-x-2">
                    <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg flex items-center action-btn">
                        <i data-lucide="filter" class="w-4 h-4 mr-2"></i>
                        Lọc
                    </button>
                </div>
            </div>

<!--            &lt;!&ndash; Tab Navigation &ndash;&gt;-->
<!--            <div class="border-b border-gray-200 mb-6">-->
<!--                <nav class="-mb-px flex space-x-8">-->
<!--                    <a href="#" class="tab-active whitespace-nowrap py-4 px-1 font-medium text-sm">-->
<!--                        Tất cả công ty-->
<!--                    </a>-->
<!--                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">-->
<!--                        Chờ duyệt-->
<!--                    </a>-->
<!--                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">-->
<!--                        Đã duyệt-->
<!--                    </a>-->
<!--                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">-->
<!--                        Đã từ chối-->
<!--                    </a>-->
<!--                </nav>-->
<!--            </div>-->

<!--            &lt;!&ndash; Search and Filter &ndash;&gt;-->
<!--            <div class="bg-white rounded-lg shadow p-4 mb-6">-->
<!--                <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">-->
<!--                    <div class="relative w-full md:w-64">-->
<!--                        <input type="text" placeholder="Tìm kiếm công ty..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">-->
<!--                        <i data-lucide="search" class="absolute left-3 top-2.5 text-gray-400 w-5 h-5"></i>-->
<!--                    </div>-->
<!--                    <div class="flex space-x-2">-->
<!--                        <select class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">-->
<!--                            <option>Tất cả ngành nghề</option>-->
<!--                            <option>Công nghệ thông tin</option>-->
<!--                            <option>Tài chính - Ngân hàng</option>-->
<!--                            <option>Bảo hiểm</option>-->
<!--                            <option>Viễn thông</option>-->
<!--                        </select>-->
<!--                        <select class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">-->
<!--                            <option>Tất cả quy mô</option>-->
<!--                            <option>Dưới 50 nhân viên</option>-->
<!--                            <option>50-200 nhân viên</option>-->
<!--                            <option>200-1000 nhân viên</option>-->
<!--                            <option>Trên 1000 nhân viên</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

            <!-- Company List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Công ty
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Nhà tuyển dụng phụ trách
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Địa điểm
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Thông tin pháp lý
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Trạng thái
                            </th>
                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Thao tác
                            </th>
                        </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                        <!-- Company 1 -->
                        <tr th:each="c:${companies}" class="company-row">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <img class="h-10 w-10 rounded-full"
                                             th:src="@{'/images/companies/'+${c.imageUrl==null?'default/img_3.png':c.id+'/'+c.imageUrl}}" alt="">
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900" th:text="${c.companyName}">FPT Software</div>
                                        <div class="text-sm text-gray-500" th:text="${c.website==null?'---------':c.website}">fptsoftware.com</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900" th:text="${c.recruiter.firstName+' '+c.recruiter.lastName}">Công nghệ phần mềm</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900" th:text="${c.district.displayName+', TpHCM'}">Hà Nội, TP.HCM</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold  status-active"
                                      th:classappend="${c.trangThai()}"
                                      th:text="${c.color()}"></span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                    <span th:text="${c.operated?'Đang hoạt động':'Ngừng hoạt động'}"
                                            class="px-2 inline-flex text-xs leading-5 font-semibold  status-active">
                                    </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                <button class="text-blue-600 hover:text-blue-900 mr-3 action-btn" title="Xem chi tiết" th:onclick="|openCompanyModalFetch(${c.id})|">
                                    <i data-lucide="eye" class="w-4 h-4"></i>
                                </button>
                                <button class="text-green-600 hover:text-green-900 mr-3 action-btn" title="Duyệt">
                                    <i data-lucide="check-circle" class="w-4 h-4"></i>
                                </button>
                                <button class="text-red-600 hover:text-red-900 action-btn" title="Từ chối">
                                    <i data-lucide="x-circle" class="w-4 h-4"></i>
                                </button>
                            </td>
                        </tr>

                        <!-- Company 2 -->
<!--                        <tr class="company-row">-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="flex items-center">-->
<!--                                    <div class="flex-shrink-0 h-10 w-10">-->
<!--                                        <img class="h-10 w-10 rounded-full" src="https://via.placeholder.com/40" alt="">-->
<!--                                    </div>-->
<!--                                    <div class="ml-4">-->
<!--                                        <div class="text-sm font-medium text-gray-900">Viettel Cyber Security</div>-->
<!--                                        <div class="text-sm text-gray-500">viettel.com.vn</div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">An ninh mạng</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">500+ nhân viên</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">Hà Nội</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full status-pending">-->
<!--                                        Chờ duyệt-->
<!--                                    </span>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">-->
<!--                                <button class="text-blue-600 hover:text-blue-900 mr-3 action-btn" title="Xem chi tiết" onclick="openCompanyModal()">-->
<!--                                    <i data-lucide="eye" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                                <button class="text-green-600 hover:text-green-900 mr-3 action-btn" title="Duyệt">-->
<!--                                    <i data-lucide="check-circle" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                                <button class="text-red-600 hover:text-red-900 action-btn" title="Từ chối">-->
<!--                                    <i data-lucide="x-circle" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                            </td>-->
<!--                        </tr>-->

<!--                        &lt;!&ndash; Company 3 &ndash;&gt;-->
<!--                        <tr class="company-row">-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="flex items-center">-->
<!--                                    <div class="flex-shrink-0 h-10 w-10">-->
<!--                                        <img class="h-10 w-10 rounded-full" src="https://via.placeholder.com/40" alt="">-->
<!--                                    </div>-->
<!--                                    <div class="ml-4">-->
<!--                                        <div class="text-sm font-medium text-gray-900">VinAI Research</div>-->
<!--                                        <div class="text-sm text-gray-500">vinai.io</div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">Trí tuệ nhân tạo</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">100+ nhân viên</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                <div class="text-sm text-gray-900">Hà Nội</div>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap">-->
<!--                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full status-inactive">-->
<!--                                        Từ chối-->
<!--                                    </span>-->
<!--                            </td>-->
<!--                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">-->
<!--                                <button class="text-blue-600 hover:text-blue-900 mr-3 action-btn" title="Xem chi tiết" onclick="openCompanyModal()">-->
<!--                                    <i data-lucide="eye" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                                <button class="text-green-600 hover:text-green-900 mr-3 action-btn" title="Duyệt">-->
<!--                                    <i data-lucide="check-circle" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                                <button class="text-red-600 hover:text-red-900 action-btn" title="Từ chối">-->
<!--                                    <i data-lucide="x-circle" class="w-4 h-4"></i>-->
<!--                                </button>-->
<!--                            </td>-->
<!--                        </tr>-->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div class="flex items-center justify-between mt-6">
                <div class="text-sm text-gray-500">
                    Hiển thị <span class="font-medium">1</span> đến <span class="font-medium">3</span> của <span class="font-medium">12</span> kết quả
                </div>
                <div class="flex space-x-2">
                    <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        Trước
                    </button>
                    <button class="px-3 py-1 border border-blue-500 rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                        1
                    </button>
<!--                    <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">-->
<!--                        2-->
<!--                    </button>-->
<!--                    <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">-->
<!--                        3-->
<!--                    </button>-->
                    <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        Sau
                    </button>
                </div>
            </div>
        </div>

        <!-- Company Detail Modal -->
        <div class="fixed inset-0 overflow-y-auto z-50 hidden" id="companyDetailModal">
            <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0 modal-overlay">
                <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                    <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
                </div>
                <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
                <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full modal-content">
                    <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                        <div class="sm:flex sm:items-start">
                            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-lg leading-6 font-medium text-gray-900" id="modalTitle">
                                        Chi tiết công ty
                                    </h3>
                                    <button type="button" class="close-modal text-gray-400 hover:text-gray-500">
                                        <i data-lucide="x" class="w-6 h-6"></i>
                                    </button>
                                </div>

                                <!-- Tab Navigation -->
                                <div class="border-b border-gray-200 mt-4">
                                    <nav class="-mb-px flex space-x-8">
                                        <button onclick="switchTab('info')" id="infoTab" class="tab-active whitespace-nowrap py-4 px-1 font-medium text-sm">
                                            Thông tin công ty
                                        </button>
                                        <button onclick="switchTab('documents')" id="documentsTab" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                                            Giấy tờ pháp lý
                                        </button>
                                    </nav>
                                </div>

                                <!-- Info Tab Content -->
                                <div id="infoContent" class="mt-6">
                                    <div class="flex items-start mb-6">
                                        <div class="flex-shrink-0 h-16 w-16">
                                            <img class="h-16 w-16 rounded-full" id="image-comany-detail"
                                                 src="https://via.placeholder.com/64" alt="">
                                        </div>
                                        <div class="ml-4">
                                            <h2 class="text-xl font-bold text-gray-900" id="companye-name-detail">
                                                FPT Software
                                            </h2>
                                            <div class="flex items-center mt-1 text-sm text-gray-500">
                                                <i data-lucide="globe" class="w-4 h-4 mr-1" id="website-detail"></i>
                                                fptsoftware.com
                                                <span class="mx-2">•</span>
                                                <i data-lucide="users" class="w-4 h-4 mr-1" id="company-size-detail"></i>
                                                2000+ nhân viên
                                                <span class="mx-2">•</span>
                                                <i data-lucide="map-pin" class="w-4 h-4 mr-1" id="district-detail"></i>
                                                Hà Nội, TP.HCM
                                            </div>
                                        </div>

                                        <!-- ✅ Thêm đoạn text góc phải -->
                                        <div id="inforAp"
                                                class="ml-auto text-sm text-gray-500">
                                            Đối tác VIP
                                        </div>
                                    </div>


                                    <div class="mb-6">
                                        <h3 class="text-lg font-medium text-gray-900 mb-2">Giới thiệu công ty</h3>
                                        <div class="prose max-w-none text-gray-600" id="des-detail">
                                            <p>FPT Software là công ty phần mềm hàng đầu Việt Nam với hơn 20,000 nhân viên trên toàn cầu. Chúng tôi cung cấp các giải pháp công nghệ cho khách hàng tại 50 quốc gia.</p>
                                            <p>Thành lập năm 1999, FPT Software đã phát triển thành một trong những công ty công nghệ lớn nhất Đông Nam Á với doanh thu hàng năm đạt hơn 500 triệu USD.</p>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <h3 class="text-lg font-medium text-gray-900 mb-2">Thông tin liên hệ</h3>
                                            <div class="space-y-2 text-gray-600">
                                                <div class="flex items-center">
                                                    <i data-lucide="phone" class="w-4 h-4 mr-2"></i>
                                                    <span  id="phone-detail">>024 7300 8899</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <i data-lucide="mail" class="w-4 h-4 mr-2"></i>
                                                    <span  id="email-detail">
                                                    >contact@fptsoftware.com</span>
                                                </div>

                                            </div>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-medium text-gray-900 mb-2">Thông tin pháp lý</h3>
                                            <div class="space-y-2 text-gray-600">
                                                <div class="flex items-center">
                                                    <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                                    <span  id="taxcode-detail">
                                                     >Mã số thuế: 0101244567</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <i data-lucide="map-pin" class="w-4 h-4 mr-2"></i>
                                                    <span  id="address-detail">
                                                    >Tòa nhà FPT, 17 Duy Tân, Cầu Giấy, Hà Nội</span>
                                                </div>
<!--                                                <div class="flex items-center">-->
<!--                                                    <i data-lucide="calendar" class="w-4 h-4 mr-2"></i>-->
<!--                                                    <span>Ngày thành lập: 13/09/1999</span>-->
<!--                                                </div>-->
<!--                                                <div class="flex items-center">-->
<!--                                                    <i data-lucide="clipboard" class="w-4 h-4 mr-2"></i>-->
<!--                                                    <span>Giấy phép ĐKKD số: 0101244567</span>-->
<!--                                                </div>-->
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-6">
                                        <h3 class="text-lg font-medium text-gray-900 mb-2">Lĩnh vực hoạt động</h3>
                                        <div class="flex flex-wrap gap-2">
                                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">Công Nghệ và Giáo dục</span>
                                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">Outsourcing</span>
                                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">Trí tuệ nhân tạo</span>
                                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">Điện toán đám mây</span>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                        <button type="button" id="infor"
                                                class="w-full inline-flex justify-center rounded-md border
                                                 border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium
                                                 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2
                                                 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                                            Duyệt thông tin công ty
                                        </button>
                                        <button type="button" id="inforRe"
                                                class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300
                                                shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50
                                                focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0
                                                sm:ml-3 sm:w-auto sm:text-sm">
                                            Từ chối
                                        </button>
                                        <button type="button" class="close-modal mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                                            Đóng
                                        </button>
                                    </div>
                                </div>

                                <!-- Documents Tab Content -->
                                <div id="documentsContent" class="mt-6 hidden">
                                    <div class="mb-6">
                                        <!-- Bọc tiêu đề và text góc phải trong flex -->
                                        <div class="flex items-center justify-between mb-2">
                                            <h3 class="text-lg font-medium text-gray-900">
                                                Giấy chứng nhận đăng ký doanh nghiệp
                                            </h3>
                                            <div id="cerAp"
                                                    class="text-sm text-gray-500">Đã xác minh</div> <!-- ✅ Text góc phải -->
                                        </div>

                                        <img id="certificate-detail">

<!--                                        <div class="document-preview" onclick="openDocumentFullscreen('')">-->
<!--                                            <div class="text-center">-->
<!--                                                <i data-lucide="file-text" class="w-12 h-12 mx-auto text-gray-400"></i>-->
<!--                                                <p class="mt-2 text-sm text-gray-500">Nhấn để xem toàn màn hình</p>-->
<!--                                            </div>-->
<!--                                        </div>-->

                                        <div class="mt-2 text-sm text-gray-500">
                                            <p><span class="font-medium">Ngày cấp:</span> 15/03/2010</p>
                                            <p><span class="font-medium">Ngày hết hạn:</span> 15/03/2030</p>
                                        </div>
                                    </div>



                                    <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                        <button type="button" id="cer"
                                                class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                                            Duyệt chứng chỉ công ty
                                        </button>
                                        <button type="button" id="cerRe"
                                                class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                                            Từ chối
                                        </button>
                                        <button type="button" class="close-modal mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                                            Đóng
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Document Fullscreen Modal -->
        <div class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-90" id="documentModal">
            <div class="relative w-full h-full flex items-center justify-center">
                <button type="button" class="absolute top-4 right-4 text-white hover:text-gray-300" onclick="closeDocumentFullscreen()">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
                <img id="fullscreenDocument" src="" alt="Document" class="max-w-full max-h-full">
            </div>
        </div>
    </div>
</div>

<script>
    window.addEventListener('DOMContentLoaded', function () {
        const hash = window.location.hash;
        if (hash.startsWith('#companyDetailModal-')) {
            const id = hash.replace('#companyDetailModal-', '');
            openCompanyModalFetch(id)
            history.replaceState(null, null, window.location.pathname + window.location.search);
        }
    });
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize Lucide icons
        lucide.createIcons();

        // Modal handling
        const modal = document.getElementById('companyDetailModal');
        const openModalButtons = document.querySelectorAll('[onclick="openCompanyModal()"]');
        const closeModalButtons = document.querySelectorAll('.close-modal');

        openModalButtons.forEach(button => {
            button.addEventListener('click', () => {
                modal.classList.remove('hidden');
            });
        });

        closeModalButtons.forEach(button => {
            button.addEventListener('click', () => {
                modal.classList.add('hidden');
            });
        });

        // Close modal when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('hidden');
            }
        });
    });

    function switchTab(tabName) {
        // Hide all tab contents
        document.getElementById('infoContent').classList.add('hidden');
        document.getElementById('documentsContent').classList.add('hidden');

        // Remove active class from all tabs
        document.getElementById('infoTab').classList.remove('tab-active');
        document.getElementById('infoTab').classList.add('border-transparent', 'text-gray-500');
        document.getElementById('documentsTab').classList.remove('tab-active');
        document.getElementById('documentsTab').classList.add('border-transparent', 'text-gray-500');

        // Show selected tab content and set active tab
        document.getElementById(tabName + 'Content').classList.remove('hidden');
        document.getElementById(tabName + 'Tab').classList.add('tab-active');
        document.getElementById(tabName + 'Tab').classList.remove('border-transparent', 'text-gray-500');
    }

    function openDocumentFullscreen(src) {
        document.getElementById('fullscreenDocument').src = src;
        document.getElementById('documentModal').classList.remove('hidden');
    }

    function closeDocumentFullscreen() {
        document.getElementById('documentModal').classList.add('hidden');
    }

    // For demo purposes
    function openCompanyModal() {
        document.getElementById('companyDetailModal').classList.remove('hidden');
    }

    function formatValue(value) {
        return value ? value : '---------';
    }
    async function openCompanyModalFetch(id){
        let response = await fetch('/admin/api/company-infomation/'+id)
        if(response.ok){
            let data = await response.json()
            // Gán dữ liệu vào các phần tử HTML
            document.getElementById('companye-name-detail').textContent = formatValue(data.companyName);
            document.getElementById('website-detail').nextSibling.textContent = formatValue(data.companyWebsite);
            document.getElementById('company-size-detail').nextSibling.textContent = formatValue(data.companySize);
            document.getElementById('district-detail').nextSibling.textContent = formatValue(data.district);
            document.getElementById('image-comany-detail').src = data.image || '/images/companies/default/img_3.png';
            // Mô tả công ty
            const desDetail = document.getElementById('des-detail');
            desDetail.innerHTML = `${data.description}`;

            // Thông tin liên hệ
            document.getElementById('phone-detail').textContent = formatValue(data.companyPhone);
            document.getElementById('email-detail').textContent = formatValue(data.companyEmail);

            // Thông tin pháp lý
            document.getElementById('address-detail').textContent = formatValue(data.companyAddress);
            document.getElementById('taxcode-detail').textContent = formatValue(data.taxCode);

            // Ảnh giấy phép kinh doanh nếu có
            const certificateImg = document.getElementById('certificate-detail');
            certificateImg.src = data.certificate

            document.getElementById('companyDetailModal').classList.remove('hidden');
            const infor =  document.getElementById('infor')
            const inforRe =  document.getElementById('inforRe')
            const cer =  document.getElementById('cer')
            const cerRe =  document.getElementById('cerRe')
            infor.classList.add('hidden')
            inforRe.classList.add('hidden')
            if(!data.checkInfor ) {
                if(!data.taxCode)
                document.getElementById('inforAp').innerHTML =
                    `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-gray'>Chưa cập nhật thông tin công ty</span>`
                else
                    document.getElementById('inforAp').innerHTML =
                        `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-inactive'>Từ chối</span>`
            }
            if(data.checkInfor === 'yes')
                document.getElementById('inforAp').innerHTML =
                    `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-active'>Đã duyệt</span>`
            if (data.checkInfor === 'no') {
                document.getElementById('inforAp').innerHTML =
                    `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-pending'>Chờ duyệt</span>`
                infor.classList.remove('hidden')
                inforRe.classList.remove('hidden')
                infor.addEventListener("click",async ()=>{
                    let response = await fetch('/admin/api/update-info',{
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            id: data.id,
                            check: true
                        })
                    })
                    if(response.ok){
                        window.location.href= window.location.pathname
                    }
                })
                inforRe.addEventListener("click",async ()=>{
                    let response = await fetch('/admin/api/update-info',{
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            id: data.id,
                            check: null
                        })
                    })
                    if(response.ok){
                        window.location.href= window.location.pathname
                    }
                })

            }
            cer.classList.add('hidden')
            cerRe.classList.add('hidden')

            if(!data.checkCer ) {
                if(!data.taxCode)
                    document.getElementById('cerAp').innerHTML =
                        `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-gray'>Chưa cập nhật chứng chỉ công ty</span>`
                else
                    document.getElementById('cerAp').innerHTML =
                        `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-inactive'>Từ chối</span>`
            }
            if(data.checkCer === 'yes')
                document.getElementById('cerAp').innerHTML =
                    `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-active'>Đã duyệt</span>`
            if (data.checkCer === 'no') {
                document.getElementById('cerAp').innerHTML =
                    `<span class='px-2 inline-flex text-xs leading-5 font-semibold  status-pending'>Chờ duyệt</span>`
                cer.classList.remove('hidden')
                cerRe.classList.remove('hidden')
                cer.addEventListener("click",async ()=>{
                    let response = await fetch('/admin/api/update-cer',{
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            id: data.id,
                            check: true
                        })
                    })
                    if(response.ok){
                        window.location.href= window.location.pathname
                    }
                })
                cerRe.addEventListener("click",async ()=>{
                    let response = await fetch('/admin/api/update-cer',{
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            id: data.id,
                            check: null
                        })
                    })
                    if(response.ok){
                        window.location.href= window.location.pathname
                    }
                })
            }

        }
    }
    // Dropdown Menu Toggle
    const dropdownBtns = document.querySelectorAll('.dropdown-btn');
    dropdownBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const content = btn.nextElementSibling;
            const icon = btn.querySelector('i:last-child');

            content.classList.toggle('hidden');
            icon.classList.toggle('rotate-180');
        });
    });
</script>
</body>
</html>